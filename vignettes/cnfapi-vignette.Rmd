---
title: "Vignette for the nutrientr Package"
author: "Sara Hall, Justine Filion, Saisree Gownipalli Ramanaiah"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{cnfapi-vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(nutrientr)
library(ggplot)
```

## Description

The `nutrientr` package is an R wrapper for the [Canadian Nutrient File (CNF) API](https://hc-sc.api.canada.ca/en/detail?api=cnf). It contains information about commonly consumed foods in Canada. There are eight different endpoints that give access to different types of information. 

- The food endpoint gives a list of food ids and their corresponding description (name). 
- The nutrientamount endpoint gives lists of the amounts of different nutrients in the foods. 
- The nutrientgroup endpoint gives nutrient groups (eg. carbohydrates, others), and their corresponding ids. 
- The nutrientname endpoint give the ids of different nutrients and their corresponding names, symbols, units, etc. 
- The nutrientsource endpoint gives information about where information about nutrients was pulled from (eg. FDA).
- The refuseamount endpoint gives information about the amount of food waste for different foods (eg. the inedible portion of the foods - like bones). 
- The servingsize endpoint gives the servings sizes for the different foods. 
- The yieldamount endpoint gives the amount of food needed to get the desired quantity of end product (eg. the amount of dried gravy powder to make 100 mLs).

## Getting Started - API Access Key

In order to use the `nutrientr` package, you will need to get an API key from the [Canada Open Data API Store](https://hc-sc.api.canada.ca/en/detail?api=cnf). Once you have this, you can either set is as a system environment variable using `Sys.setenv(CN_API = 'your_API_key_here')` or pass it as a parameter to the functions. 

## Function Usage

The `nutrientr` package contains several function that wrap the CNF API endpoints listed above in the description. The following documentation will give examples of how to use them. 


### `get_food()`

The `get_food()` function retrieves food information from the CNF based on user search terms. An overview of the search terms and function arguments includes:

- **foodCode**: List of foodCode of foods available. The values depend on each endpoint. 
- **lang**:  Define which language you would like the response to be in query string
- **apiKey**: If an API key is not set in the environment, an access key can be passed directly into a function.


An example of using `get_food()` to search for the food with food_code as 5 would be as follows:

```{r}
get_food(foodCode = 5)
```
### Nutrient Amount information

The `get_nutrientamount()`, `get_nutrientgroup()` , `get_nutrientname()` , `get_nutrientsource()` functions retrieve nutrient amount information from the CNF based on user search terms. An overview of the search terms and function arguments includes:

- **foodCode**: List of foodCode of foods available. The values depend on each endpoint. 
- **nutrientGroupId**:  List of nutrient group ids available.
- **nutrientNameId**: List of all nutrient names for all the foods
- **nutrientSourceId**: List of all nutrient sources listed by their source id
- **lang**:  Define which language you would like the response to be in query string
- **apiKey**: If an API key is not set in the environment, an access key can be passed directly into a function.

If a user wanted to search and return the all nutrient amount information, `get_nutrientamount()` could be used:

```{r}
get_nutrientamount(foodCode = 2314)
```
or if a user wanted to search and return the nutrient group information of nutrient_group_id of 7, `get_nutrientgroup()` could be used:
```{r}
get_nutrientgroup(nutrientGroupId = 7)
```
or if a user wanted to search and return the nutrient name information of nutrient_name_id of 550, `get_nutrientname()` could be used:
```{r}
get_nutrientname()
```
or if a user wanted to search and return the all nutrient source information , `get_nutrientsource()` could be used:
```{r}
get_nutrientsource()
```
### Refuse Amount

The `get_refuseamount()` function retrieves refuse amount information from the CNF based on user search terms. An overview of the search terms and function arguments includes:

- **foodCode**: List of foodCode of foods available. The values depend on each endpoint.  
- **lang**:  Define which language you would like the response to be in query string
- **apiKey**: If an API key is not set in the environment, an access key can be passed directly into a function.

If a user wanted to search and return the all refuse amount information , `get_refuseamount()` could be used:
```{r}
get_refuseamount()
```
### Serving Size

The `get_servingsize()` functions all retrieve serving sizes information from the CNF based on user search terms. An overview of the search terms and function arguments includes:

- **foodCode**: List of foodCode of foods available. The values depend on each endpoint.  
- **lang**:  Define which language you would like the response to be in query string
- **apiKey**: If an API key is not set in the environment, an access key can be passed directly into a function.

If a user wanted to search and return the all serving size information , `get_servingsize()` could be used:
```{r}
get_servingsize()
```
### Yield Amount
The `get_yieldamount()`function retrieves yield information from the CNF based on user search terms. An overview of the search terms and function arguments includes:

- **foodCode**: List of foodCode of foods available. The values depend on each endpoint.  
- **lang**:  Define which language you would like the response to be in query string
- **apiKey**: If an API key is not set in the environment, an access key can be passed directly into a function.

If a user wanted to search and return the all yield amount information , `get_yieldamount()` could be used:
```{r}
get_yieldamount()
```

